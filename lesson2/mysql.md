# MySql

## Урок 2.

## Создаём таблицу c названием goods:

```sql
CREATE TABLE `goods` (  `id` serial, `title` varchar(255), `description` longtext, 
                        `short_annotation` tinytext, 
                        `vendor_code` char(8) NOT NULL, 
                        `image_url` varchar(255), 
                        `price` decimal(8,2) unsigned NOT NULL,
                        `sales_start_day` timestamp DEFAULT CURRENT_TIMESTAMP,
                        `quantity` smallint unsigned, 
                        `exists` boolean DEFAULT false);
```
Некоторые типы полей намеренно экспериментальны. Например поле "price" имеет тип decimal, хотя в реальном проекте это было бы оправданно наверное только для отображения курса валют.
 Кроме того поле описание - "description" имеет тип longtext хотя понятно что переполнить это поле очень сложно. Поле Краткое описание - "short_annotation" имеет тип tinyint, хотя
 правильнее было бы сделать varchar. По сути для кирилицы в utf8 это varchar(127), но без возможности расширения.
  Кроме того, у нас в поле цена и количество не должны быть отрицательными числами, а поле цена не может быть пустым.
  Поле артикул - vendor_code это просто некий номер для внутреннего учета ТМЦ, состоящий из 8 цифр.
  Поле "sales_start_day" благодаря дефолтному значению, если поле пустое, автоматически генерирует при создании записи текущую
  дату.
####Сразу хотелось бы обратить внимание на поле "exists" - наличие товара. Несмотря на то что присвоенное значение по умолчанию было false, при просмотре структуры таблицы отображается значение "0"

###Вставим демо-данные в таблицу
### Запросы в версии 5.6.29
```sql
INSERT INTO `goods` (`title`, `description`, `short_annotation`, `vendor_code`, `image_url`, `price`, `quantity`, `exists`)
VALUES ('WeThePeople Envy', 
        'Он всегда совершенен. Тем не менее, из года в год мы одержимы желанием сделать его ещё лучше, байком мечты любого райдера, желающего кататься как Про. Его рама и вилка, выполненные на 100% из 4130 Sanco, получившие термообработку и захватывающий дух дизайн Black Titan. Гармоничное дополнение в виде россыпи украшающих фреймсет компонентов Eclat, включая жирные покрышки Stevie Churchill Signature и шатуны Aeon, готовые крошить бетон. Трепетное внимание к деталям выражено и в наличие втулок Blind, за качество которых ручается сам Shane Weston. Зверь, вызывающий зависть, стал ещё лучше.', 

        'Главной особенностью велосипеда BMX является полное отсутствие подвески и наличие всего лишь одной передачи. В остальном же вариации могут быть разными. Еще одно, не менее важное отличие - очень маленький вес, в пределах 11 кг.', 
        12124322,
        '/images/bicycle1.png', 
        44040,
        7,
        1);
```
#### Всё вставилось, ожидаемо обрезался текст в поле `short_annotation`.

#### Вставим ещё один запрос:
```sql
INSERT INTO `goods` (`title`, `description`, `short_annotation`, `vendor_code`, `image_url`, `price`, `quantity`, `exists`)
VALUES ('Norco AURUM C7.1',
        'Этот карбоновый боец создан в тесном сотрудничестве с командой Norco Factory Racing и проверен в гонках Кубка мира по даунхиллу. Технология изменения размеров рамы Gravity Tune позволяет райдеру найти идеальную посадку и правильно распределять вес тела. Колеса 650B пришли в скоростной спуск всерьез и надолго, а вместе с ними вы получаете дополнительное сцепление в поворотах и меньше тряски на неровностях. Трансмиссия X0 DH на 7 скоростей и карбоновые шатуны от Sram существенно облегчают байк, а руль Race Face из углеволокна шириной 800 мм делает управление легким и точным в любых условиях.',

        'Горный велосипед - двухподвес',
        432563473,
        '/images/bicycle2.png',
        241120,
        2,
        true);
```
На этот раз была "допущена" ошибка в артикуле, вместо 8 цифр было вставлено 9. И снова как ни в чём не бывало вместо артикула
№432563473 в запросе был вставлен номер 43256347.

### Выполним ещё один запрос на вставку данных:
```sql
INSERT INTO `goods` (`title`, `description`, `short_annotation`, `vendor_code`, `image_url`, `price`, `quantity`, `exists`)
VALUES ('GT FORCE X Carbon PRO',
        'Разнообразие – вот, пожалуй, самое короткое и емкое определение All Mountain. Любой из Force проведет вас везде, где только может проехать велосипед, и бережно вернет домой. А флагман линейки Force X Carbon Pro сделает это с необычайными легкостью и изяществом. Полностью карбоновая рама с подвеской A.O.S. 150 миллиметров, колеса 27.5 дюймов, элитный набор компонентов - всё в этом байке нацелено на то, что вы проведете в седле весь день, покорите новые вершины, насладитесь длинными спусками, а когда вернетесь домой – будете с улыбкой вспоминать прошедший день и планировать новые приключения.',

        'Горный велосипед - двухподвес даунхил',
         2324668,
        '/images/bicycle3.png',
        '241120',
        3,
        '');
```
Теперь вместо boolean мы засунули не true или false, не 0 или 1, а пустую строку. В таблицу вставилось значение 0, что означает false.
Внесем ещё одну такую же запись, только строка будет заполнена. Вставим в неё true. Точно такой же результат. Вставляли 'true'
получили false т.е. 0. Т.е. для булева типа чтобы значение было true нужно вводить true или 1, иначе будет false
### Ещё одна запись:
```sql
INSERT INTO `goods` (`title`, `description`, `short_annotation`, `vendor_code`, `image_url`, `price`, `quantity`, `exists`)
VALUES ('Jamis XENITH PRO',
        'Для многих людей шоссейный велосипед олицетворяет единственную правильную сущность двухколесной машины. Именно для таких людей Jamis из года в год совершенствует свою шоссейную линейку, и эта модель весом 7,2 кг отвечает самым высоким требованиям любителей гонок по асфальту. Полностью карбоновая рама и вилка, а также оборудование Sram Force22 позволят не только тренироваться с максимальной эффективностью, но и бороться за победу в соревнованиях.',

        'Шоссейный велосипед нового поколения',
        12145468,
        '/images/bicycle4.png',
        241120,
        2,
        100);
```
Теперь в колонку с типом boolean мы вставили число 100. И что самое удивиельное, в базу данных это самое число и вставилось.
Это вызывает недоумение, в чём тогда смысл типа boolean в mysql?
### Повтороим все те же запросы в версии mysql 5.7.11
```sql
INSERT INTO `goods` (`title`, `description`, `short_annotation`, `vendor_code`, `image_url`, `price`, `quantity`, `exists`)
VALUES ('WeThePeople Envy', 
        'Он всегда совершенен. Тем не менее, из года в год мы одержимы желанием сделать его ещё лучше, байком мечты любого райдера, желающего кататься как Про. Его рама и вилка, выполненные на 100% из 4130 Sanco, получившие термообработку и захватывающий дух дизайн Black Titan. Гармоничное дополнение в виде россыпи украшающих фреймсет компонентов Eclat, включая жирные покрышки Stevie Churchill Signature и шатуны Aeon, готовые крошить бетон. Трепетное внимание к деталям выражено и в наличие втулок Blind, за качество которых ручается сам Shane Weston. Зверь, вызывающий зависть, стал ещё лучше.', 

        'Главной особенностью велосипеда BMX является полное отсутствие подвески и наличие всего лишь одной передачи. В остальном же вариации могут быть разными. Еще одно, не менее важное отличие - очень маленький вес, в пределах 11 кг.', 
        12124322,
        '/images/bicycle1.png', 
        44040,
        7,
        0);
```
#### Получаем ошибку
```sql
Ошибка в запросe (1406): Data too long for column 'short_annotation' at row 1
```
Надо бы сократить строку
# Следующий запрос
```sql
INSERT INTO `goods` (`title`, `description`, `short_annotation`, `vendor_code`, `image_url`, `price`, `quantity`, `exists`)
VALUES ('Norco AURUM C7.1',
        'Этот карбоновый боец создан в тесном сотрудничестве с командой Norco Factory Racing и проверен в гонках Кубка мира по даунхиллу. Технология изменения размеров рамы Gravity Tune позволяет райдеру найти идеальную посадку и правильно распределять вес тела. Колеса 650B пришли в скоростной спуск всерьез и надолго, а вместе с ними вы получаете дополнительное сцепление в поворотах и меньше тряски на неровностях. Трансмиссия X0 DH на 7 скоростей и карбоновые шатуны от Sram существенно облегчают байк, а руль Race Face из углеволокна шириной 800 мм делает управление легким и точным в любых условиях.',

        'Горный велосипед - двухподвес',
        432563473,
        '/images/bicycle2.png',
        241120,
        2,
        true);
```
####Получаем ту же самую ошибку:
```sql
#1406 - Data too long for column 'vendor_code' at row 1
```
8 цифр, не больше
###Следующий:
```sql
INSERT INTO `goods` (`title`, `description`, `short_annotation`, `vendor_code`, `image_url`, `price`, `quantity`, `exists`)
VALUES ('GT FORCE X Carbon PRO',
        'Разнообразие – вот, пожалуй, самое короткое и емкое определение All Mountain. Любой из Force проведет вас везде, где только может проехать велосипед, и бережно вернет домой. А флагман линейки Force X Carbon Pro сделает это с необычайными легкостью и изяществом. Полностью карбоновая рама с подвеской A.O.S. 150 миллиметров, колеса 27.5 дюймов, элитный набор компонентов - всё в этом байке нацелено на то, что вы проведете в седле весь день, покорите новые вершины, насладитесь длинными спусками, а когда вернетесь домой – будете с улыбкой вспоминать прошедший день и планировать новые приключения.',

        'Горный велосипед - двухподвес даунхил',
         2324668,
        '/images/bicycle3.png',
        '241120',
        3,
        '');
```
И опять неудчача:
```sql
#1366 - Incorrect integer value: '' for column 'exists' at row 1
```
Если вставить в строку true, то ровно такой же результат. MySql не читает что там внутри строки. А вот если вставить в строку
1 или 0 то всё сработает ожидаемо, поскольку здесь уже действуют общие правила, когда число можно записывать и в кавычках и без.
Нельзя вставлять строки в boolean
###И последнее:
```sql
INSERT INTO `goods` (`title`, `description`, `short_annotation`, `vendor_code`, `image_url`, `price`, `quantity`, `exists`)
VALUES ('Jamis XENITH PRO',
        'Для многих людей шоссейный велосипед олицетворяет единственную правильную сущность двухколесной машины. Именно для таких людей Jamis из года в год совершенствует свою шоссейную линейку, и эта модель весом 7,2 кг отвечает самым высоким требованиям любителей гонок по асфальту. Полностью карбоновая рама и вилка, а также оборудование Sram Force22 позволят не только тренироваться с максимальной эффективностью, но и бороться за победу в соревнованиях.',

        'Шоссейный велосипед нового поколения',
        12145468,
        '/images/bicycle4.png',
        241120,
        2,
        100);
```
А этот запрос прошёл на ура, в boolean снова 100!